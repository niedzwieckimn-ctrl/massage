generator client { provider = "prisma-client-js" }

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Service {
  id          Int       @id @default(autoincrement())
  name        String
  durationMin Int
  price       Int
  active      Boolean   @default(true)
  bookings    Booking[]
}

model Staff {
  id       Int       @id @default(autoincrement())
  name     String
  active   Boolean   @default(true)
  bookings Booking[]
  slots    Slot[]
}

model Slot {
  id        Int      @id @default(autoincrement())
  start     DateTime
  end       DateTime
  staff     Staff?   @relation(fields: [staffId], references: [id])
  staffId   Int?
  booking   Booking?
  isActive  Boolean  @default(true)

  @@index([start, end])
}

model Customer {
  id       Int       @id @default(autoincrement())
  email    String    @unique
  name     String
  phone    String?
  bookings Booking[]
}

model Booking {
  id        Int       @id @default(autoincrement())
  service   Service   @relation(fields: [serviceId], references: [id])
  serviceId Int
  customer  Customer  @relation(fields: [customerId], references: [id])
  customerId Int
  slot      Slot      @relation(fields: [slotId], references: [id])
  slotId    Int       @unique
  status    Status    @default(PENDING)
  notes     String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

enum Status { PENDING CONFIRMED CANCELLED }
